import { expect } from "chai";
import { BytesLike } from "ethers";
import { ethers } from "hardhat";
import {
  AccusationsLibraryMock,
  ValidatorPool,
  ValidatorPoolMock,
} from "../../typechain-types";

export const deployLibrary = async (): Promise<AccusationsLibraryMock> => {
  const _Contract = await ethers.getContractFactory("AccusationsLibraryMock");
  const instance = await _Contract.deploy();
  await instance.deployed();
  return instance as AccusationsLibraryMock;
};

export const generateSigAndPClaims0 = () => {
  const pClaims =
    "0x" +
    "0000000000000200" +
    "04000000" +
    "02000400" +
    "58000000" +
    "00000200" +
    // BClaim
    "01000000" +
    "02000000" +
    "01000000" +
    "00000000" +
    "0d000000" +
    "02010000" +
    "19000000" +
    "02010000" +
    "25000000" +
    "02010000" +
    "31000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    "de8b68a6643fa528a513f99a1ea30379927197a097ca86d9108e4c29d684b1ec" +
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    // Rcert
    "04000000" +
    "02000100" +
    "1d000000" +
    "02060000" +
    // RClaim
    "01000000" +
    "02000000" +
    "01000000" +
    "00000000" +
    "01000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    // SigGroup
    "258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b" +
    "1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a6" +
    "0f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e" +
    "0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb1" +
    "1ff56a9538b079e16dd77a8ef81318497b195ad81b8cd1c5ea5d48b0c160f599" +
    "12387b5ab69538ef4cda0f7a879982f9b4943291b1e6d998abefe7bb4ebb6993";
  const sig =
    "0x" +
    "05d08b3bfd0fcb21e00a1468a9013fb023aa5eb86d714600dd69675ef9acce8c" +
    "3247fe575e3d16a3e32d1e0ea10a30474744e7aab3166daea7c591776c1e942500";
  return { sig, pClaims };
};

export const generateSigAndPClaims1 = () => {
  // Second PClaims, this time containg 2 transactions instead of 1.
  const pClaims =
    "0x" +
    "0000000000000200" +
    "04000000" +
    "02000400" +
    "58000000" +
    "00000200" +
    "01000000" +
    "02000000" +
    "02000000" + // txCount is different
    "00000000" +
    "0d000000" +
    "02010000" +
    "19000000" +
    "02010000" +
    "25000000" +
    "02010000" +
    "31000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    "8db49c526748abbf9eabf4b49e9edd6d91ca3c970791b027e815b628c148afd0" + // txRoot is different
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    "04000000" +
    "02000100" +
    "1d000000" +
    "02060000" +
    "01000000" +
    "02000000" +
    "01000000" +
    "00000000" +
    "01000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    "258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b" +
    "1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a6" +
    "0f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e" +
    "0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb1" +
    "1ff56a9538b079e16dd77a8ef81318497b195ad81b8cd1c5ea5d48b0c160f599" +
    "12387b5ab69538ef4cda0f7a879982f9b4943291b1e6d998abefe7bb4ebb6993";

  const sig =
    "0x" +
    "534ebe41176f66ffaaa3dd387e097b998b51576ed0a8fbc3f9c8a1b14699adb2" +
    "0dc69ad5e32d78ccd4a964af065cfa76c23b6009ae877c1d748494776abfae6f00";
  return { sig, pClaims };
};

export const generateSigAndPClaimsDifferentHeight = () => {
  const pClaims =
    "0x" +
    "0000000000000200" +
    "04000000" +
    "02000400" +
    "58000000" +
    "00000200" +
    "01000000" +
    "03000000" + // different height
    "01000000" +
    "00000000" +
    "0d000000" +
    "02010000" +
    "19000000" +
    "02010000" +
    "25000000" +
    "02010000" +
    "31000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    "de8b68a6643fa528a513f99a1ea30379927197a097ca86d9108e4c29d684b1ec" +
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    "04000000" +
    "02000100" +
    "1d000000" +
    "02060000" +
    "01000000" +
    "03000000" + // different height
    "01000000" +
    "00000000" +
    "01000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    "258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b" +
    "1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a6" +
    "0f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e" +
    "0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb1" +
    "1ff56a9538b079e16dd77a8ef81318497b195ad81b8cd1c5ea5d48b0c160f599" +
    "12387b5ab69538ef4cda0f7a879982f9b4943291b1e6d998abefe7bb4ebb6993";
  const sig =
    "0x" +
    "b9c42c4e41a2df9040f061756dcd6ca47ec2042cbd9f22519309a553be6a1dcc" +
    "69ab71d5d8b002b9d8814fb1fee17e071fe37cc052cced7f8a57354e9bb8956a01";
  return { sig, pClaims };
};

export const generateSigAndPClaimsDifferentRound = () => {
  const pClaims =
    "0x" +
    "0000000000000200" +
    "04000000" +
    "02000400" +
    "58000000" +
    "00000200" +
    "01000000" +
    "02000000" +
    "01000000" +
    "00000000" +
    "0d000000" +
    "02010000" +
    "19000000" +
    "02010000" +
    "25000000" +
    "02010000" +
    "31000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    "de8b68a6643fa528a513f99a1ea30379927197a097ca86d9108e4c29d684b1ec" +
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    "04000000" +
    "02000100" +
    "1d000000" +
    "02060000" +
    "01000000" +
    "02000000" +
    "02000000" + // different round
    "00000000" +
    "01000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    "258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b" +
    "1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a6" +
    "0f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e" +
    "0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb1" +
    "1ff56a9538b079e16dd77a8ef81318497b195ad81b8cd1c5ea5d48b0c160f599" +
    "12387b5ab69538ef4cda0f7a879982f9b4943291b1e6d998abefe7bb4ebb6993";
  const sig =
    "0x" +
    "2f8df0cad1b95c978d0feb132f777459c2efc8204ec79bd6d17d31e4d50611c8" +
    "7c5a37d4f4a6838c9427b53749fda98970227dbd7364713abd24c2a14f5a36a601";
  return { sig, pClaims };
};

export const generateSigAndPClaimsDifferentChainId = () => {
  const pClaims =
    "0x" +
    "0000000000000200" +
    "04000000" +
    "02000400" +
    "58000000" +
    "00000200" +
    "0b000000" +
    "02000000" +
    "01000000" +
    "00000000" +
    "0d000000" +
    "02010000" +
    "19000000" +
    "02010000" +
    "25000000" +
    "02010000" +
    "31000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    "de8b68a6643fa528a513f99a1ea30379927197a097ca86d9108e4c29d684b1ec" +
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    "c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470" +
    "04000000" +
    "02000100" +
    "1d000000" + // different chainId
    "02060000" +
    "0b000000" +
    "02000000" +
    "01000000" +
    "00000000" +
    "01000000" +
    "02010000" +
    "f75f3eb17cd8136aeb15cca22b01ad5b45c795cb78787e74e55e088a7aa5fa16" +
    "258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b" +
    "1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a6" +
    "0f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e" +
    "0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb1" +
    "1ff56a9538b079e16dd77a8ef81318497b195ad81b8cd1c5ea5d48b0c160f599" +
    "12387b5ab69538ef4cda0f7a879982f9b4943291b1e6d998abefe7bb4ebb6993";

  const sig =
    "0x" +
    "4343b877b15485ba84c8907cf982957f138466e2907572235d0ffe848b57c031" +
    "577e854335594ef6c99efe01e18f3fa40093b4741a3fc67080da7c1ae8111b7a01";

  return { sig, pClaims };
};

export const getValidAccusationDataForNonExistentUTXO = () => {
  const pClaims =
    "0x000000000000020004000000020004005800000000000200010000000200000001000000000000000d00000002010000190000000201000025000000020100003100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964afa368ad44a1ae7ea22d0857c32da7e679fb29c4357e4de838394faf0bd57e14930d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a47004000000020001001d00000002060000010000000200000001000000000000000100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964af258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb106f5308b02f59062b735d0021ba93b1b9c09f3e168384b96b1eccfed659357142a7bd3532dc054cb5be81e9d559128229d61a00474b983a3569f538eb03d07ce";

  const pClaimsSig =
    "0x51cacd39457727591e75c61733f38447039d3bc7dd326fa946d2136ed14cacfe2f0a1421c17e26b644b0c3fca9b38907cd90de93b9a75e8cfccfad50b351ae3000";

  const bClaims =
    "0x0000000002000400010000000100000005000000000000000d0000000201000019000000020100002500000002010000310000000201000041b1a0649752af1b28b3dc29a1556eee781e4a4c3a1f7f53f90fa834de098c4d3d9261b2bee4a635db058a9f13572c18c8d092182125ddd96ca58c3f405993f00d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";

  const bClaimsSigGroup =
    "0x258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb106f5308b02f59062b735d0021ba93b1b9c09f3e168384b96b1eccfed659357142a7bd3532dc054cb5be81e9d559128229d61a00474b983a3569f538eb03d07ce";

  const proofs: [BytesLike, BytesLike, BytesLike] = [
    // proofAgainstStateRootCapnProto
    "0x000004da3dc36dc016d513fbac07ed6605c6157088d8c673df3b5bb09682b7937d52500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010003d0686741a9adaa231d9555e49c4a4c96bf30992aaaf2784df9ae047a21364ce138fb9eb5ced6edc2826e734abad6235c8cf638c812247fd38f04e7080d431933b9c6d6f24756341fde3e8055dd3a83743a94dddc122ab3f32a3db0c4749ff57bad",

    // proofInclusionTXRootCapnProto
    "0x0100006e286c26d8715685894787919c58c9aeee7dff73f88bf476dab1d282d535e5f200000000000000000000000000000000000000000000000000000000000000007015f14a90fd8c32ff946f17def605bccdee5f828a0dcd5c8e373346d41547a40001000000",

    // proofInclusionTXHashCapnProto
    "0x010005da3dc36dc016d513fbac07ed6605c6157088d8c673df3b5bb09682b7937d52500000000000000000000000000000000000000000000000000000000000000000059fb90cd9bd014b03f9967c7258b7fe11bb03415c0331926d5cbcaa3e89582300010002885bfe473b114836cb46eaac9f8dc3f250cac5f74e60f42419a180a419842a8291b3dc4df7060209ffb1efa66f693ed888c15034398312231b51894f86343c2421",
  ];

  const txInPreImage =
    "0x000000000100010001000000000000000100000002010000f172873c63909462ac4de545471fd3ad3e9eeadeec4608b92d16ce6b500704cc";
  return {
    pClaims,
    pClaimsSig,
    bClaims,
    bClaimsSigGroup,
    txInPreImage,
    proofs,
  };
};

export const getAccusationDataForNonExistentUTXOWithInvalidSigGroup = () => {
  const pClaims =
    "0x000000000000020004000000020004005800000000000200010000000200000001000000000000000d00000002010000190000000201000025000000020100003100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964afa368ad44a1ae7ea22d0857c32da7e679fb29c4357e4de838394faf0bd57e14930d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a47004000000020001001d00000002060000010000000200000001000000000000000100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964af258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb106f5308b02f59062b735d0021ba93b1b9c09f3e168384b96b1eccfed659357142a7bd3532dc054cb5be81e9d559128229d61a00474b983a3569f538eb03d07ce";

  const pClaimsSig =
    "0x51cacd39457727591e75c61733f38447039d3bc7dd326fa946d2136ed14cacfe2f0a1421c17e26b644b0c3fca9b38907cd90de93b9a75e8cfccfad50b351ae3000";

  const bClaims =
    "0x0000000002000400010000000100000005000000000000000d0000000201000019000000020100002500000002010000310000000201000041b1a0649752af1b28b3dc29a1556eee781e4a4c3a1f7f53f90fa834de098c4d3d9261b2bee4a635db058a9f13572c18c8d092182125ddd96ca58c3f405993f00d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";

  const bClaimsSigGroup =
    "0x257aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb106f5308b02f59062b735d0021ba93b1b9c09f3e168384b96b1eccfed659357142a7bd3532dc054cb5be81e9d559128229d61a00474b983a3569f538eb03d07ce";

  const proofs: [BytesLike, BytesLike, BytesLike] = [
    // proofAgainstStateRootCapnProto
    "0x000004da3dc36dc016d513fbac07ed6605c6157088d8c673df3b5bb09682b7937d52500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010003d0686741a9adaa231d9555e49c4a4c96bf30992aaaf2784df9ae047a21364ce138fb9eb5ced6edc2826e734abad6235c8cf638c812247fd38f04e7080d431933b9c6d6f24756341fde3e8055dd3a83743a94dddc122ab3f32a3db0c4749ff57bad",

    // proofInclusionTXRootCapnProto
    "0x0100006e286c26d8715685894787919c58c9aeee7dff73f88bf476dab1d282d535e5f200000000000000000000000000000000000000000000000000000000000000007015f14a90fd8c32ff946f17def605bccdee5f828a0dcd5c8e373346d41547a40001000000",

    // proofInclusionTXHashCapnProto
    "0x010005da3dc36dc016d513fbac07ed6605c6157088d8c673df3b5bb09682b7937d52500000000000000000000000000000000000000000000000000000000000000000059fb90cd9bd014b03f9967c7258b7fe11bb03415c0331926d5cbcaa3e89582300010002885bfe473b114836cb46eaac9f8dc3f250cac5f74e60f42419a180a419842a8291b3dc4df7060209ffb1efa66f693ed888c15034398312231b51894f86343c2421",
  ];

  const txInPreImage =
    "0x000000000100010001000000000000000100000002010000f172873c63909462ac4de545471fd3ad3e9eeadeec4608b92d16ce6b500704cc";
  return {
    pClaims,
    pClaimsSig,
    bClaims,
    bClaimsSigGroup,
    txInPreImage,
    proofs,
  };
};

export const getValidAccusationDataForNonExistentUTXOChainId2 = () => {
  const pClaims =
    "0x000000000000020004000000020004005800000000000200010000000200000001000000000000000d00000002010000190000000201000025000000020100003100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964afb272723f931f12cc652801de2f17ec7bdcb9d07f278d9141627c0624b355860c0d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a47004000000020001001d000000020600003905000002000000010000000000000001000000020100007b6c0a886db63b181a4f9a07fce864b3c9f0a0891e887fdc4eb40f3e2a6f2166258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb101f52552e41cc14911677bc02205762473c8cffc3576d80613614d724f908aee10e7f1cd3be6d341db09d97db691f3029fe39f7c77cb3654dea89b654f27567c";

  const pClaimsSig =
    "0x2c6476cda2497b60214c25ac4dad853c528ae1f29e72fc415f874e6a66a07199183f5dd8e70b4fe38e87b23dce81ccb8826f44aea9db69da53201c953a15582a00";

  const bClaims =
    "0x0000000002000400390500000100000005000000000000000d0000000201000019000000020100002500000002010000310000000201000041b1a0649752af1b28b3dc29a1556eee781e4a4c3a1f7f53f90fa834de098c4d3d9261b2bee4a635db058a9f13572c18c8d092182125ddd96ca58c3f405993f00d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";

  const bClaimsSigGroup =
    "0x258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb101f52552e41cc14911677bc02205762473c8cffc3576d80613614d724f908aee10e7f1cd3be6d341db09d97db691f3029fe39f7c77cb3654dea89b654f27567c";

  const proofs: [BytesLike, BytesLike, BytesLike] = [
    // proofAgainstStateRootCapnProto
    "0x010005cda80a6c60e1215c1882b25b4744bd9d95c1218a2fd17827ab809c68196fd9bf0000000000000000000000000000000000000000000000000000000000000000af469f3b9864a5132323df8bdd9cbd59ea728cd7525b65252133a5a02f1566ee00010003a8793650a7050ac58cf53ea792426b97212251673788bf0b4045d0bb5bdc3843aafb9eb5ced6edc2826e734abad6235c8cf638c812247fd38f04e7080d431933b9c6d6f24756341fde3e8055dd3a83743a94dddc122ab3f32a3db0c4749ff57bad",

    // proofInclusionTXRootCapnProto
    "0x010000b4aec67f3220a8bcdee78d4aaec6ea419171e3db9c27c65d70cc85d60e07a3f70000000000000000000000000000000000000000000000000000000000000000111c8c4c333349644418902917e1a334a6f270b8b585661a91165298792437ed0001000000",

    // proofInclusionTXHashCapnProto
    "0x010002cda80a6c60e1215c1882b25b4744bd9d95c1218a2fd17827ab809c68196fd9bf0000000000000000000000000000000000000000000000000000000000000000db3b45f6122fb536c80ace7701d8ade36fb508adf5296f12edfb1dfdbb242e0d00010002c042a165d6c097eb5ac77b72581c298f93375322fc57a03283891c2acc2ce66f8cb3dc4df7060209ffb1efa66f693ed888c15034398312231b51894f86343c2421",
  ];

  const txInPreImage =
    "0x0000000001000100010000000000000001000000020100007b802d223569d7b75cec992b1b028b0c2092d950d992b11187f11ee568c469bd";
  return {
    pClaims,
    pClaimsSig,
    bClaims,
    bClaimsSigGroup,
    txInPreImage,
    proofs,
  };
};

export const getValidAccusationDataForNonExistentUTXOWithInvalidHeight = () => {
  const pClaims =
    "0x000000000000020004000000020004005800000000000200010000000200000001000000000000000d00000002010000190000000201000025000000020100003100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964afb272723f931f12cc652801de2f17ec7bdcb9d07f278d9141627c0624b355860c0d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a47004000000020001001d00000002060000010000002b00000001000000000000000100000002010000e55971c068dfd3470789c2b5526722a60d2778a6a0c115ed619649a37193c562258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb10adab566e80068b7fde61c5fe805e08b723d93b09b1486ecb5cc5e951ecb702f27abdbaa9163e21992d8e5c6bc4e3c3bcd52fbbefe847c7e4bbbe70c0cf2cb7d";

  const pClaimsSig =
    "0xbeb08c869247ee91975dd4d3bef87e2bad44faf315c8a13f69ffc0105f436ffd2080f6ca6ecce9794dfdae18e6a20830ab2928b0cc4c2d481f686941bc79286400";

  const bClaims =
    "0x0000000002000400010000002a00000005000000000000000d0000000201000019000000020100002500000002010000310000000201000041b1a0649752af1b28b3dc29a1556eee781e4a4c3a1f7f53f90fa834de098c4d3d9261b2bee4a635db058a9f13572c18c8d092182125ddd96ca58c3f405993f00d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";

  const bClaimsSigGroup =
    "0x258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb10adab566e80068b7fde61c5fe805e08b723d93b09b1486ecb5cc5e951ecb702f27abdbaa9163e21992d8e5c6bc4e3c3bcd52fbbefe847c7e4bbbe70c0cf2cb7d";

  const proofs: [BytesLike, BytesLike, BytesLike] = [
    // proofAgainstStateRootCapnProto
    "0x010005cda80a6c60e1215c1882b25b4744bd9d95c1218a2fd17827ab809c68196fd9bf0000000000000000000000000000000000000000000000000000000000000000af469f3b9864a5132323df8bdd9cbd59ea728cd7525b65252133a5a02f1566ee00010003a8793650a7050ac58cf53ea792426b97212251673788bf0b4045d0bb5bdc3843aafb9eb5ced6edc2826e734abad6235c8cf638c812247fd38f04e7080d431933b9c6d6f24756341fde3e8055dd3a83743a94dddc122ab3f32a3db0c4749ff57bad",

    // proofInclusionTXRootCapnProto
    "0x010000b4aec67f3220a8bcdee78d4aaec6ea419171e3db9c27c65d70cc85d60e07a3f70000000000000000000000000000000000000000000000000000000000000000111c8c4c333349644418902917e1a334a6f270b8b585661a91165298792437ed0001000000",

    // proofInclusionTXHashCapnProto
    "0x010002cda80a6c60e1215c1882b25b4744bd9d95c1218a2fd17827ab809c68196fd9bf0000000000000000000000000000000000000000000000000000000000000000db3b45f6122fb536c80ace7701d8ade36fb508adf5296f12edfb1dfdbb242e0d00010002c042a165d6c097eb5ac77b72581c298f93375322fc57a03283891c2acc2ce66f8cb3dc4df7060209ffb1efa66f693ed888c15034398312231b51894f86343c2421",
  ];

  const txInPreImage =
    "0x0000000001000100010000000000000001000000020100007b802d223569d7b75cec992b1b028b0c2092d950d992b11187f11ee568c469bd";
  return {
    pClaims,
    pClaimsSig,
    bClaims,
    bClaimsSigGroup,
    txInPreImage,
    proofs,
  };
};

export const getValidAccusationDataWithDoubleSpentDeposit = () => {
  const pClaims =
    "0x000000000000020004000000020004005800000000000200010000000200000001000000000000000d00000002010000190000000201000025000000020100003100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964afe025b75676058e9ce45178a8462da70dac3ae495f342fe5e222614ccab7e4d720d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a47004000000020001001d00000002060000010000000200000001000000000000000100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964af258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb106f5308b02f59062b735d0021ba93b1b9c09f3e168384b96b1eccfed659357142a7bd3532dc054cb5be81e9d559128229d61a00474b983a3569f538eb03d07ce";

  const pClaimsSig =
    "0x72092a7de7ecb4faf7920c424cb656624695396aac14a0b1091eeb141eb584fb3a9b4335a8d1ab584bb823b90bb456eedc318175ac0f95857a0c5e93e7e5da3b01";

  const bClaims =
    "0x0000000002000400010000000100000005000000000000000d0000000201000019000000020100002500000002010000310000000201000041b1a0649752af1b28b3dc29a1556eee781e4a4c3a1f7f53f90fa834de098c4d3d9261b2bee4a635db058a9f13572c18c8d092182125ddd96ca58c3f405993f00d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";

  const bClaimsSigGroup =
    "0x258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb106f5308b02f59062b735d0021ba93b1b9c09f3e168384b96b1eccfed659357142a7bd3532dc054cb5be81e9d559128229d61a00474b983a3569f538eb03d07ce";

  const proofs: [BytesLike, BytesLike, BytesLike] = [
    // proofAgainstStateRootCapnProto
    "0x010100000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000be3ba01ddd6fb3d58ff1e8b79b7db6db5ef6376d877f7ca88e0c78e141da9fa00210006e00000000000000000000000000000000000000000000000000000000000002300166eacf747876e3a8eb60fdd36cfac41e9ae27098cf605d90a019a895e98af171ddb3652b5ecb0881027ca462000d3614fd7735855db004c598622855e9190c49bd43690efe794fff0a9790fc9c3f694e251cd15dbf06a5217005cffc23943c254ec9d782b8991251f91af85390450ad21fc2befaf8f473367a30d579c36e221480543d6cc63a90d7c121e5219495ebc0091dd7355763da9d97931997f52260b1c925246c3b9255ebd67fc7daf4769f556b5eaefbd62d31daf7f6c43da4ffe2c",

    // proofInclusionTXRootCapnProto
    "0x0100007b802d223569d7b75cec992b1b028b0c2092d950d992b11187f11ee568c469bd00000000000000000000000000000000000000000000000000000000000000006b5c11c9ed7bc16231e80c801decf57a31fbde8394e58d943477328a6e0da5330001000000",

    // proofInclusionTXHashCapnProto
    "0x010003000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000be3ba01ddd6fb3d58ff1e8b79b7db6db5ef6376d877f7ca88e0c78e141da9fa00010001808214ecf817f6c48eb8dd9e602fe03cf9e1bd1e449108f6203785ff49852f2976",
  ];

  const txInPreImage =
    "0x000000000100010001000000ffffffff01000000020100000000000000000000000000000000000000000000000000000000000000000030";
  return {
    pClaims,
    pClaimsSig,
    bClaims,
    bClaimsSigGroup,
    txInPreImage,
    proofs,
  };
};

export const getInvalidAccusationDataWithSpendingValidDeposit = () => {
  const pClaims =
    "0x000000000000020004000000020004005800000000000200010000000200000001000000000000000d00000002010000190000000201000025000000020100003100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964afb272723f931f12cc652801de2f17ec7bdcb9d07f278d9141627c0624b355860c0d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a47004000000020001001d00000002060000010000000200000001000000000000000100000002010000fb9caafb31a4d4cada31e5d20ef0952832d8f37a70aa40c7035a693199e964af258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb106f5308b02f59062b735d0021ba93b1b9c09f3e168384b96b1eccfed659357142a7bd3532dc054cb5be81e9d559128229d61a00474b983a3569f538eb03d07ce";

  const pClaimsSig =
    "0x7b31cfb72e13e8824cca1e3059f3c1c8d8fda42852f0564a98ac1ec0c6568df03e15af96eeb2882035d823167ed4a3ab2d9b5927fee27caaf78b7e89119b319001";

  const bClaims =
    "0x0000000002000400010000000100000005000000000000000d0000000201000019000000020100002500000002010000310000000201000041b1a0649752af1b28b3dc29a1556eee781e4a4c3a1f7f53f90fa834de098c4d3d9261b2bee4a635db058a9f13572c18c8d092182125ddd96ca58c3f405993f00d66a8a0babec3d38b67b5239c1683f15a57e087f3825fac3d70fd6a243ed30bc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";

  const bClaimsSigGroup =
    "0x258aa89365a642358d92db67a13cb25d73e6eedf0d25100d8d91566882fac54b1ccedfb0425434b54999a88cd7d993e05411955955c0cfec9dd33066605bd4a60f6bbfbab37349aaa762c23281b5749932c514f3b8723cf9bb05f9841a7f2d0e0f75e42fd6c8e9f0edadac3dcfb7416c2d4b2470f4210f2afa93138615b1deb106f5308b02f59062b735d0021ba93b1b9c09f3e168384b96b1eccfed659357142a7bd3532dc054cb5be81e9d559128229d61a00474b983a3569f538eb03d07ce";

  const proofs: [BytesLike, BytesLike, BytesLike] = [
    // proofAgainstStateRootCapnProto

    "0x010005cda80a6c60e1215c1882b25b4744bd9d95c1218a2fd17827ab809c68196fd9bf0000000000000000000000000000000000000000000000000000000000000000af469f3b9864a5132323df8bdd9cbd59ea728cd7525b65252133a5a02f1566ee00010003a8793650a7050ac58cf53ea792426b97212251673788bf0b4045d0bb5bdc3843aafb9eb5ced6edc2826e734abad6235c8cf638c812247fd38f04e7080d431933b9c6d6f24756341fde3e8055dd3a83743a94dddc122ab3f32a3db0c4749ff57bad",

    // proofInclusionTXRootCapnProto
    "0x010000b4aec67f3220a8bcdee78d4aaec6ea419171e3db9c27c65d70cc85d60e07a3f70000000000000000000000000000000000000000000000000000000000000000111c8c4c333349644418902917e1a334a6f270b8b585661a91165298792437ed0001000000",

    // proofInclusionTXHashCapnProto
    "0x010002cda80a6c60e1215c1882b25b4744bd9d95c1218a2fd17827ab809c68196fd9bf0000000000000000000000000000000000000000000000000000000000000000db3b45f6122fb536c80ace7701d8ade36fb508adf5296f12edfb1dfdbb242e0d00010002c042a165d6c097eb5ac77b72581c298f93375322fc57a03283891c2acc2ce66f8cb3dc4df7060209ffb1efa66f693ed888c15034398312231b51894f86343c2421",
  ];

  const txInPreImage =
    "0x0000000001000100010000000000000001000000020100007b802d223569d7b75cec992b1b028b0c2092d950d992b11187f11ee568c469bd";
  return {
    pClaims,
    pClaimsSig,
    bClaims,
    bClaimsSigGroup,
    txInPreImage,
    proofs,
  };
};

// Helper functions to create validators
export const generateMadID = (id: Number) => {
  return [id, id];
};

export const addValidators = async (
  validatorPool: ValidatorPoolMock | ValidatorPool,
  validators: string[]
) => {
  if ((<ValidatorPoolMock>validatorPool).isMock) {
    for (const validator of validators) {
      expect(await validatorPool.isValidator(validator)).to.equal(false);
      await validatorPool.registerValidators([validator], [0]);
      expect(await validatorPool.isValidator(validator)).to.equal(true);
    }
  }
};

export const generateAccusationID = (
  validatorAddress: string,
  chainId: number,
  height: number,
  round: number,
  preSalt: string
): string => {
  return ethers.utils.solidityKeccak256(
    ["address", "uint32", "uint32", "uint32", "bytes32"],
    [validatorAddress, chainId, height, round, preSalt]
  );
};
